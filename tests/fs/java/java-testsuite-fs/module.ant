<!--
	ANT
	
	Copyright 2020 MicroEJ Corp. All rights reserved.
	Use of this source code is governed by a BSD-style license that can be found with this software.
-->
<project name="jpf.testsuite.fs" xmlns:ea="antlib:org.apache.easyant" xmlns:ivy="antlib:org.apache.ivy.ant"  xmlns:ac="antlib:net.sf.antcontrib">
	
	<dirname file="${ant.file.jpf.testsuite.fs}" property="project"/>
	<dirname file="${project}" property="workspace.dir"/>
	
	<!-- Set the launch.test.trace.file when the  testsuite.trace.ip -->
	<condition property="microej.testsuite.properties.launch.test.trace.file">
		<not>
			<isset property="microej.testsuite.properties.testsuite.trace.ip" />
		</not>
	</condition>


	<!-- We should rename the embPartialLink launch to fullLink if a fullLink does not exist and an embPartialLink exist -->
	<target name="jpf:rename-launch-check">
		<condition property="should.rename.launch">
			<and>
				<available file="${microej-testsuite.platform.dir}/scripts/embPartialLink.microejLaunch" type="file" />
				<not>
					<available file="${microej-testsuite.platform.dir}/scripts/fullLink.microejLaunch" type="file" />
				</not>
			</and>
		</condition>
	</target>

	<target name="jpf:rename-launch" depends="jpf:rename-launch-check" if="should.rename.launch" extensionOf="microej-testsuite:test-ready">
		<move file="${microej-testsuite.platform.dir}/scripts/embPartialLink.microejLaunch" 
			tofile="${microej-testsuite.platform.dir}/scripts/fullLink.microejLaunch" />
	</target>
</project>